<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>72h Clock Week Scheduler</title>
<style>
/* --- Body & General --- */
body {
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    padding: 40px;              /* comfortable space from edges */
    background-color: #121212;
    color: #eee;
}

/* Center scheduler and constrain max width for readability */
.scheduler {
    display: flex;
    flex-direction: column;     /* stacked layout */
    gap: 30px;
    max-width: 1200px;          /* keeps content from stretching too wide */
    margin: 0 auto;             /* center horizontally */
    width: 100%;
    box-sizing: border-box;
}

/* Headings */
h1, h3 {
    color: #fff;
    margin-bottom: 10px;
}

/* --- Stats Box --- */
.stats {
    margin-bottom: 20px;
    background: #1e1e1e;
    padding: 20px 25px;         /* padding for readability */
    border-radius: 12px;
    box-shadow: 0 0 15px #000;
    font-size: 24px;
}

/* --- Form --- */
.form {
    background: #1e1e1e;
    padding: 25px;               /* comfortable inner padding */
    border-radius: 12px;
    box-shadow: 0 0 20px #000;
    width: 100%;
    box-sizing: border-box;
}

.form label {
    display: block;
    margin-bottom: 10px;
}

input, select, textarea, button {
    width: 100%;
    max-width: 100%;
    padding: 10px;               /* enough space for touch/desktop */
    margin-top: 4px;
    border-radius: 6px;
    border: none;
    background: #2c2c2c;
    color: #eee;
    box-sizing: border-box;
    font-size: 16px;
}

/* --- Buttons --- */
button {
    padding: 12px;
    border-radius: 8px;
    border: none;
    background: #3a86ff;
    color: #fff;
    cursor: pointer;
    margin-top: 10px;
    width: 100%;
    font-size: 16px;
}

button:hover {
    background: #5aa0ff;
}

/* --- Events Table --- */
.events {
    width: 100%;
    max-width: 100%;
    overflow-x: auto;            /* horizontal scroll if table is too wide */
}

table {
    width: 100% !important;      /* ensure table spans full container */
    border-collapse: collapse;
    margin-top: 10px;
    font-size: 14px;
    table-layout: auto;          /* flexible column widths */
}

th, td {
    border: 1px solid #333;
    padding: 10px;               /* comfortable spacing */
    text-align: center;
    word-break: break-word;      /* wrap long content */
}

th {
    background-color: #222;
}

tr:nth-child(even) {
    background-color: #1b1b1b;
}

td button {
    padding: 6px 10px;
    width: auto;
    background: #ff5f5f;
    font-size: 14px;
}

td button:hover {
    background: #ff7f7f;
}

/* --- Import / Export Section --- */
.importExport {
    margin-top: 20px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.importExport button {
    width: 100%;
    box-sizing: border-box;
}

textarea {
    width: 100%;
    box-sizing: border-box;
    resize: vertical;
    font-size: 14px;
    padding: 10px;
}

/* --- Responsive Adjustments --- */
@media screen and (max-width: 700px) {
    body {
        padding: 20px;            /* slightly less padding on smaller screens */
    }

    table {
        font-size: 13px;
    }
}

@media screen and (max-width: 400px) {
    input, select, textarea, button {
        font-size: 15px;
        padding: 10px;
    }

    table {
        font-size: 12px;
    }

    td button {
        font-size: 12px;
        padding: 5px 8px;
    }
}
</style>

</head>
<body>

<h1>72h Clock Week Scheduler</h1>

<div class="stats" id="currentStats"></div>

<div class="scheduler">


	<div class="events">
        <h3>Scheduled Tasks</h3>
        <table>
            <thead>
                <tr>
                    <th>Title</th>
                    <th>72h Time</th>
                    <th>24h Time</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="eventTableBody"></tbody>
        </table>
    </div>
    
    
    <div class="form">
        <h3>Add Task</h3>
        <label>Title:<input type="text" id="eventTitle"></label>

        <label>Input Type:
            <select id="inputType">
                <option value="triplex">72h</option>
                <option value="standard">24h</option>
            </select>
        </label>

        <div id="triplexInputs">
            <label>72h Day (1-7):<input type="number" id="triplexDay" min="1" max="7" value="1"></label>
            <label>72h Time (HH:MM):<input type="text" id="triplexTime" placeholder="HH:MM"></label>
        </div>

        <div id="standardInputs" style="display:none;">
            <label>24h Day (1-21):<input type="number" id="standardDay" min="1" max="21" value="1"></label>
            <label>24h Time (HH:MM):<input type="text" id="standardTime" placeholder="HH:MM"></label>
        </div>

        <button onclick="addEvent()">Add Task</button>

        <div class="importExport">
            <div style="display:flex; gap:4%;">
                <button onclick="exportTasks()">Export Tasks</button>
                <button onclick="importTasks()">Import Tasks</button>
            </div>
            <textarea id="taskText" rows="6" placeholder="Exported/imported tasks appear here..."></textarea>
        </div>
    </div>

    
</div>

<script>
const TRIPLEX_DAY_HOURS = 72;
const DISPLAY_HOURS = 24;
const TRIPLEX_WEEK_DAYS = 7;
const standard_DAYS_PER_WEEK = 21;
const TRIPLEX_WEEKDAYS = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
const standard_WEEKDAYS = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

// --- Conversion Functions ---
function standardToTriplex(date = new Date()) {
    const localEpoch = new Date(1970,0,1);
    const msSinceEpoch = date - localEpoch;
    const standardHours = msSinceEpoch / 3600000;
    const triplexHour = standardHours % TRIPLEX_DAY_HOURS;
    const displayHourFraction = (triplexHour / TRIPLEX_DAY_HOURS) * DISPLAY_HOURS;
    const hours = Math.floor(displayHourFraction);
    const minutes = Math.floor((displayHourFraction - hours) * 60);
    const seconds = Math.floor((((displayHourFraction - hours) * 60) - minutes) * 60);
    const day = (Math.floor(standardHours / TRIPLEX_DAY_HOURS) % TRIPLEX_WEEK_DAYS) + 1; // 1-7
    return { day, hours, minutes, seconds };
}

function triplexTostandard({ day=1, hours=0, minutes=0, seconds=0 }, referenceDate=new Date()) {
    const localEpoch = new Date(1970,0,1);
    const msSinceEpoch = referenceDate - localEpoch;
    const standardHoursSinceEpoch = msSinceEpoch / 3600000;
    const triplexWeekNumber = Math.floor(standardHoursSinceEpoch / (TRIPLEX_DAY_HOURS * TRIPLEX_WEEK_DAYS));
    const triplexHour = (hours + minutes/60 + seconds/3600)/DISPLAY_HOURS*TRIPLEX_DAY_HOURS;
    const totalstandardHours = triplexWeekNumber*TRIPLEX_DAY_HOURS*TRIPLEX_WEEK_DAYS + (day-1)*TRIPLEX_DAY_HOURS + triplexHour;
    return new Date(localEpoch.getTime() + totalstandardHours*3600000);
}

function formatTime({ hours, minutes, seconds }) {
    return [hours, minutes, seconds].map(n=>n.toString().padStart(2,'0')).join(':');
}

// --- Scheduler ---
let events = [];

// Load from localStorage
function loadEvents() {
    const saved = localStorage.getItem("triplexScheduler");
    if(saved) {
        events = JSON.parse(saved);
        events.forEach(e => e.standardDate = new Date(e.standardDate));
        renderEvents();
    }
}

// Save to localStorage
function saveEvents() { localStorage.setItem("triplexScheduler", JSON.stringify(events)); }

function addEvent() {
    const title = document.getElementById("eventTitle").value.trim();
    if(!title) { alert("Please enter a title."); return; }
    const inputType = document.getElementById("inputType").value;
    let event = null;

    if(inputType === "triplex") {
        const day = parseInt(document.getElementById("triplexDay").value);
        const [hours, minutes] = document.getElementById("triplexTime").value.split(":").map(Number);
        event = { title, day, hours, minutes, seconds:0 };
        event.standardDate = triplexTostandard(event);
        event.standardDay = getstandardDayInWeek(event.standardDate);
    } else {
        const standardDay = parseInt(document.getElementById("standardDay").value);
        const [hours, minutes] = document.getElementById("standardTime").value.split(":").map(Number);
        const startOfWeek = new Date(); startOfWeek.setHours(0,0,0,0);
        const standardDate = new Date(startOfWeek.getTime() + (standardDay-1)*24*3600000 + hours*3600000 + minutes*60000);
        event = { title, standardDate, standardDay, ...standardToTriplex(standardDate) };
    }

    events.push(event);
    saveEvents();
    renderEvents();
}

// Get standard day in current week
function getstandardDayInWeek(date) {
    const startOfWeek = new Date(); startOfWeek.setHours(0,0,0,0);
    const diffDays = Math.floor((date - startOfWeek)/86400000);
    return ((diffDays % standard_DAYS_PER_WEEK) + 1);
}

function renderEvents() {
    const tbody = document.getElementById("eventTableBody");
    tbody.innerHTML = "";
    events.forEach((e,i) => {
        const triplexDayName = TRIPLEX_WEEKDAYS[(e.day-1)%7];
        const standardDayName = standard_WEEKDAYS[(e.standardDay-1)%21];
        const triplexStr = `Day ${e.day} (${triplexDayName}) ${formatTime(e)}`;
        const standardStr = `Day ${e.standardDay} (${standardDayName}) ${e.standardDate.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}`;
        const row = document.createElement("tr");
        row.innerHTML = `<td>${e.title}</td><td>${triplexStr}</td><td>${standardStr}</td>
                         <td><button onclick="removeEvent(${i})">Delete</button></td>`;
        tbody.appendChild(row);
    });
}

function updateCurrentStats() {
    const now = new Date();
    const triplex = standardToTriplex(now);
    const standardDay = getstandardDayInWeek(now);

    const triplexDayName = TRIPLEX_WEEKDAYS[(triplex.day-1)%7];
    const standardDayName = standard_WEEKDAYS[(standardDay-1)%21];

    document.getElementById("currentStats").innerHTML = `
        <strong>Current 72h Time:</strong> Day ${triplex.day} (${triplexDayName}) ${formatTime(triplex)}<br>
        <strong>Current 24h Time:</strong> Day ${standardDay} (${standardDayName}) ${now.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit', second:'2-digit'})}
    `;
}

function removeEvent(index) {
    events.splice(index,1);
    saveEvents();
    renderEvents();
}

// --- Import / Export ---
function exportTasks() {
    try {
        const txt = JSON.stringify(events, (k, v) => {
            if (k === "standardDate" && v instanceof Date) return v.toISOString();
            return v;
        }, 2);
        const textarea = document.getElementById("taskText");
        textarea.value = txt;
        textarea.select();
        //alert("Tasks exported! You can copy them from the textarea.");
    } catch(e) {
        alert("Error exporting tasks: "+e);
    }
}


function importTasks() {
    const textarea = document.getElementById("taskText");
    const txt = textarea.value.trim();
    if(!txt) { alert("No data to import."); return; }
    try {
        const arr = JSON.parse(txt);
        if(!Array.isArray(arr)) throw new Error("Invalid format");
        arr.forEach(e=>{
            e.standardDate = new Date(e.standardDate);
        });
        events = arr;
        saveEvents();
        renderEvents();
        //alert("Tasks imported successfully!");
    } catch(err) {
        alert("Invalid task data: "+err.message);
    }
}


// --- UI Switching ---
document.getElementById("inputType").addEventListener("change", e=>{
    if(e.target.value === "triplex"){
        document.getElementById("triplexInputs").style.display = "block";
        document.getElementById("standardInputs").style.display = "none";
    } else{
        document.getElementById("triplexInputs").style.display = "none";
        document.getElementById("standardInputs").style.display = "block";
    }
});



// --- Init ---
setInterval(updateCurrentStats, 1000);
updateCurrentStats();
loadEvents();
</script>

</body>
</html>
